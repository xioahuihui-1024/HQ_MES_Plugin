# MES 助手 Pro

> 专为 MES 系统打造的 Chrome 浏览器增强扩展，大幅提升工作效率。

![Version](https://img.shields.io/badge/version-3.2.6-blue)
![Manifest](https://img.shields.io/badge/manifest-v3-green)
![License](https://img.shields.io/badge/license-MIT-orange)

---

## ✨ 功能特性

### ⚡ 智能保活 (Smart Keep-Alive)

- **无感重连**：Session 过期时自动在后台静默登录，无需手动操作
- **请求重放**：拦截过期状态下的失败请求，自动登录后重新发送并展示结果
- **手动退出识别**：用户主动退出时暂停自动保活，避免干扰

### 📊 超级表格 (Advanced Table)

- **固定表头**：向下滚动时表头自动锁定，方便查看列名
- **拖拽排序**：按住列头即可随意调整列顺序
- **列宽调整**：像 Excel 一样拖动边缘调整列宽
- **列筛选/排序**：支持当前页数据的快速筛选和升降序排列
- **列显隐控制**：自由隐藏/显示不需要的列
- **视图记忆**：自动保存列宽、顺序、显隐状态，下次打开保持不变

### 🔍 增强搜索

- **Ctrl+F 搜索工具栏**：自定义表格内容搜索，支持关键词高亮
- **搜索导航**：上一个/下一个快速定位匹配结果
- **智能展开**：搜索命中时自动展开被截断的单元格内容

### 👁️ 智能展示

- **内容截断**：超长文本自动截断显示省略号，保持界面整洁
- **智能 Tooltip**：鼠标悬停时弹出浮层显示完整内容，智能定位不被遮挡
- **一键复制**：点击单元格即可弹出详情窗口并复制内容
- **日期格式化**：自动将 `20251210183000` 转换为 `25-12-10 18:30:00` 等可读格式

### 🎨 界面优化

- **菜单高亮**：左侧菜单点击后保持高亮，刷新后自动展开并定位到上次选择
- **自定义字体**：支持 JetBrains Mono、Consolas、微软雅黑等字体
- **可调间距**：紧凑/默认/宽松三档单元格间距可选
- **Google Fonts**：可选加载网络字体，提升显示效果

### 📤 数据导出

- **多格式支持**：CSV、TSV、JSON、Markdown 等格式导出
- **导出选项**：可选择仅导出可见列或全部列

---

## � 改善对比式

| 问题描述 | 改善对策 | 效果确认 |
|---------|---------|---------|
| **Session 频繁过期**：MES 系统 Session 超时短，操作中途经常弹出「登录信息已过期」，需要重新登录并手动重新查询 | 实现无感自动保活机制：拦截过期提示 → 后台静默登录 → 自动重放上次请求 | ✅ 用户无感知续期，查询结果自动恢复，工作流程不中断 |
| **表格数据难以阅读**：原生表格列宽固定，长文本撑开布局或被截断无法查看，滚动后看不到表头 | 智能列宽计算 + 内容截断省略 + 悬停 Tooltip + 固定表头 | ✅ 表格布局整洁，完整内容悬停可见，表头始终可见 |
| **表格操作不便**：无法调整列顺序，无法隐藏不需要的列，无法对数据排序筛选 | 实现高级表格管理：拖拽排序、列宽调整、列显隐、数据筛选排序 | ✅ 像 Excel 一样灵活操作表格，视图设置自动保存 |
| **菜单定位困难**：左侧菜单层级多，刷新后折叠，每次都要重新找到上次使用的功能 | 菜单高亮记忆：记录点击的菜单项，刷新后自动展开并高亮定位 | ✅ 一眼找到当前功能位置，减少重复点击 |
| **时间戳难以辨认**：系统返回 `20251210183000` 格式的时间戳，阅读困难 | 自动日期格式化：识别时间戳列，转换为 `25-12-10 18:30:00` 等可读格式 | ✅ 时间信息一目了然，支持自定义格式 |
| **数据复制麻烦**：需要手动选中单元格内容，长文本选中困难 | 点击单元格弹出详情窗口，一键复制完整内容 | ✅ 单击即可复制，效率大幅提升 |
| **浏览器搜索不好用**：Ctrl+F 原生搜索无法精准定位表格内容，搜索结果分散 | 自定义表格搜索工具栏：关键词高亮、上下导航、自动展开匹配单元格 | ✅ 快速定位目标数据，搜索体验媲美专业软件 |
| **数据导出困难**：需要手动复制粘贴或截图，格式混乱，系统自带导出中文乱码 | 多格式导出功能：支持 CSV、TSV、JSON、Markdown 一键导出，解决中文导出在部分电脑中文乱码； | ✅ 数据可直接用于报表、分析、文档编写 |

---

## 🛠️ 安装方式

1. 下载本项目源码
2. 打开 Chrome 浏览器，进入 `chrome://extensions/`
3. 开启右上角「开发者模式」
4. 点击「加载已解压的扩展程序」，选择项目文件夹
5. 点击扩展图标，授权访问 MES 网站

---

## ⚙️ 配置说明

点击扩展图标 → 「打开配置页面」进入设置中心：

| 配置项 | 说明 |
|--------|------|
| **账号与安全** | 配置 MES 用户名/密码，启用自动保活 |
| **界面视觉** | 菜单高亮颜色、固定表头、表格字体/字号/间距 |
| **表格增强** | 高级视图管理、列宽控制、搜索工具栏 |
| **数据处理** | 内容截断阈值、日期时间格式化 |

---

## 🌐 多语言支持

- 🇨🇳 简体中文 (默认)
- 🇺🇸 English

---

## 📁 项目结构

```
├── manifest.json      # 扩展配置清单
├── background.js      # Service Worker (后台登录、Cookie 管理)
├── content.js         # 内容脚本 (页面增强、表格处理)
├── inject.js          # 注入脚本 (拦截 XHR/Alert、请求重放)
├── popup.html/js      # 弹出窗口
├── options.html/js    # 配置页面
├── styles.css         # 样式文件
├── icons/             # 扩展图标
└── _locales/          # 国际化语言包
```

---

## 🔒 权限说明

| 权限 | 用途 |
|------|------|
| `storage` | 保存用户配置和视图设置 |
| `cookies` | 管理登录 Cookie，实现自动保活 |
| `webRequest` | 监控网络请求状态 |
| `scripting` | 注入内容脚本 |
| `activeTab` | 访问当前标签页 |

---

## 📝 更新日志

### v3.0.6
- 优化表格导出功能
- 增强搜索工具栏体验
- 修复若干已知问题

---

## 📄 License

MIT License
